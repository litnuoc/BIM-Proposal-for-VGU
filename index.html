<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Báo cáo Tương tác - Quản lý Không gian</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Calm Harmony (Light Slate/Gray background with Soft Blue/Teal accents) -->
    <!-- Application Structure Plan: A two-section SPA navigated by header buttons ('Indoor', 'Outdoor'). Each section uses a dashboard style with status cards and summary charts (donut for indoor progress, bar for outdoor projects). A dedicated panel shows detailed text when a user clicks on a project card, providing a drill-down experience. This structure simplifies the report's text into a clear, high-level visual summary with on-demand details, which is more intuitive than reading a linear document. -->
    <!-- Visualization & Content Choices: 1. Indoor Progress -> Goal: Inform status -> Viz: Donut Chart -> Interaction: Hover tooltips -> Justification: Shows part-to-whole completion clearly -> Library: Chart.js. 2. Outdoor Projects -> Goal: Compare progress -> Viz: Horizontal Bar Chart & Info Cards -> Interaction: Click card to update details panel and highlight chart bar -> Justification: Bar chart excels at comparing distinct items; interaction links visual summary to text details -> Library: Chart.js & Vanilla JS. 3. Detailed Text -> Goal: Provide context -> Viz: HTML text panel -> Interaction: Content updated by JS on click -> Justification: Keeps UI clean, prevents information overload -> Library: Vanilla JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .active-card {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            border-color: #0891b2; /* cyan-600 */
        }
        .main-nav-btn {
            transition: all 0.2s;
        }
        .main-nav-btn.active {
            background-color: #0891b2; /* cyan-600 */
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
         /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9; /* slate-100 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #94a3b8; /* slate-400 */
            border-radius: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b; /* slate-500 */
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        
        <header class="relative text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-cyan-800" data-lang-key="mainTitle">Dự án Quản lý Không gian Toàn diện</h1>
            <div class="absolute top-0 right-0">
                <div class="flex items-center p-1 bg-slate-200 rounded-full">
                    <button id="lang-vi" class="px-3 py-1 text-sm rounded-full bg-cyan-600 text-white shadow">VI</button>
                    <button id="lang-en" class="px-3 py-1 text-sm rounded-full">EN</button>
                </div>
            </div>
        </header>

        <nav class="flex justify-center space-x-2 md:space-x-4 mb-10 p-2 bg-slate-100 rounded-full max-w-md mx-auto shadow-inner">
            <button id="nav-proposal" class="main-nav-btn flex-1 px-4 py-2 rounded-full text-cyan-700 font-semibold" data-lang-key="navProposal">Proposal</button>
            <button id="nav-dashboard" class="main-nav-btn flex-1 px-4 py-2 rounded-full text-cyan-700 font-semibold active" data-lang-key="navDashboard">Báo cáo Tiến độ</button>
        </nav>

        <div id="app-container">

            <section id="proposal-page" class="hidden">
                 <h2 class="text-2xl md:text-3xl font-bold text-cyan-800 text-center mb-2" data-lang-key="proposalTitle">Đề xuất Kế hoạch</h2>
                 <p class="text-center text-slate-600 mb-10" data-lang-key="proposalSubtitle">Mô tả chi tiết mục tiêu và phạm vi công việc của từng hạng mục trong dự án.</p>

                 <div class="space-y-8">
                    <!-- Indoor Section -->
                    <div class="p-6 bg-white rounded-xl shadow-md">
                        <h3 class="text-2xl font-bold text-cyan-800 mb-4 border-l-4 border-cyan-500 pl-4" data-lang-key="indoorSectionTitle">Không gian Trong nhà (Indoor)</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="geoModelingTitle">Mô hình hóa Thông tin Hình học</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="geoModelingDesc"><b>Mục tiêu:</b> Xây dựng nền tảng "song sinh kỹ thuật số" (Digital Twin) cho toàn bộ 17 tòa nhà trong campus. <br><b>Phạm vi:</b> Dựng mô hình 2D và 3D chính xác, thể hiện đúng kích thước, vị trí, diện tích của từng phòng, hành lang, và các không gian chức năng khác. Đây là lớp dữ liệu cơ sở cho mọi hoạt động quản lý về sau.</p>
                            </div>
                            <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="nonGeoModelingTitle">Mô hình hóa Thông tin Phi hình học</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="nonGeoModelingDesc"><b>Mục tiêu:</b> Làm giàu mô hình hình học bằng các dữ liệu vận hành. <br><b>Phạm vi:</b> Gán các thuộc tính quan trọng vào từng không gian trong mô hình, bao gồm: mã phòng, tên gọi, chức năng sử dụng, sức chứa, tình trạng, và danh sách tài sản liên quan. Dữ liệu này giúp tối ưu hóa việc sử dụng không gian và quản lý tài sản.</p>
                            </div>
                        </div>

                        <hr class="my-6 border-slate-200">
                        <div>
                            <h4 class="text-xl font-bold text-slate-800 mb-3" data-lang-key="bridgeTitle">Cầu nối giữa Mô hình và Thực tế: Xây dựng Quy trình Vận hành</h4>
                            <p class="text-sm text-slate-600 bg-cyan-50 border-l-4 border-cyan-400 p-4 rounded-r-lg" data-lang-key="bridgeDesc">
                                Để hiện thực hóa tiềm năng của mô hình thông tin, bước tiếp theo là xây dựng một bộ <strong>hướng dẫn và quy trình vận hành</strong> chi tiết. Điều này đảm bảo rằng các nhóm có thể khai thác dữ liệu từ mô hình một cách nhất quán và hiệu quả, làm cầu nối giữa việc "có mô hình" và "sử dụng được mô hình" để thực hiện các công tác quản lý.
                            </p>
                        </div>
                        <hr class="my-6 border-slate-200">

                        <div>
                            <h4 class="text-xl font-bold text-slate-800 mb-4" data-lang-key="resultsTitle">Kết quả kỳ vọng: Các tác vụ có thể đạt được khi có quy trình vận hành</h4>
                            <div class="grid md:grid-cols-1 lg:grid-cols-3 gap-6">
                                <!-- Group I -->
                                <div class="p-4 bg-slate-50 rounded-lg">
                                    <h5 class="font-bold text-lg text-slate-700 mb-2" data-lang-key="group1Title">I. Nhóm Task Chính – Quản lý & Vận hành Cốt lõi</h5>
                                    <ul class="space-y-2 text-sm text-slate-600" data-lang-key="group1Items">
                                        <li><b>Quản lý phòng ốc:</b> Xuất Room Schedule, theo dõi tỉ lệ sử dụng, lập sơ đồ màu trực quan.</li>
                                        <li><b>Quản lý tài sản:</b> Xuất danh sách nội thất, liên kết mã tài sản, lập kế hoạch bảo trì.</li>
                                        <li><b>Quản lý cấu kiện:</b> Thống kê số lượng cửa, vật liệu để lên kế hoạch sơn sửa, thay thế.</li>
                                        <li><b>Kiểm tra quy chuẩn:</b> Đối chiếu tự động với QCVN/TCVN, flag các phòng không đạt chuẩn.</li>
                                    </ul>
                                </div>
                                <!-- Group II -->
                                <div class="p-4 bg-slate-50 rounded-lg">
                                    <h5 class="font-bold text-lg text-slate-700 mb-2" data-lang-key="group2Title">II. Nhóm Task Phụ – Phân tích & Hỗ trợ Quyết định</h5>
                                     <ul class="space-y-2 text-sm text-slate-600" data-lang-key="group2Items">
                                        <li><b>Phân tích chiếu sáng:</b> Tính tỉ lệ diện tích cửa sổ, phân tích hướng nắng để đề xuất giải pháp tiết kiệm năng lượng.</li>
                                        <li><b>Phân tích hiệu quả không gian:</b> Phát hiện phòng bị chiếm dụng sai mục đích, đề xuất tái bố trí.</li>
                                        <li><b>Phân tích vòng đời tài sản:</b> Theo dõi tuổi thọ thiết bị, ước tính chi phí bảo trì và lập kế hoạch thay thế dài hạn.</li>
                                        <li><b>Phân tích năng lượng (nâng cao):</b> Xuất mô hình sang phần mềm chuyên dụng để tính toán năng lượng tiêu thụ, tải lạnh.</li>
                                    </ul>
                                </div>
                                <!-- Group III -->
                                <div class="p-4 bg-slate-50 rounded-lg">
                                    <h5 class="font-bold text-lg text-slate-700 mb-2" data-lang-key="group3Title">III. Nhóm Task Kết Nối & Chuyển giao Dữ liệu</h5>
                                    <ul class="space-y-2 text-sm text-slate-600" data-lang-key="group3Items">
                                        <li><b>Xuất dữ liệu:</b> Export sang Excel, Power BI để tạo dashboard vận hành thời gian thực.</li>
                                        <li><b>Kết nối hệ thống:</b> Tích hợp với các phần mềm CMMS/FM để vận hành số.</li>
                                        <li><b>Bàn giao số hóa:</b> Tạo bộ hồ sơ as-built BIM cho các đơn vị liên quan.</li>
                                        <li><b>Liên kết bản đồ:</b> Tích hợp với GIS hoặc bản đồ nội bộ để quản lý trên nền tảng bản đồ.</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <hr class="my-6 border-slate-200">

                        <div>
                            <h4 class="text-xl font-bold text-slate-800 mb-4" data-lang-key="exampleTitle">Ví dụ Output từ Mô hình hóa cho Phòng mẫu (Phòng thực hành điện B3-109)</h4>
                            <p class="text-sm text-slate-600 mb-6" data-lang-key="exampleDesc">Dưới đây là một số kết quả đầu ra trực quan từ việc xây dựng mô hình thông tin cho một phòng mẫu, minh họa cho khả năng trích xuất dữ liệu của hệ thống.</p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 items-center">
                                <div class="p-3 bg-slate-50 rounded-lg">
                                    <img src="https://res.cloudinary.com/dtvjtjf4i/image/upload/v1760604848/BIM-OUTPUT_3D_view_-_NEW_a4xec9.jpg" alt="BIM 3D View" class="rounded-md shadow-sm w-full border">
                                    <p class="text-center text-sm font-semibold text-slate-600 mt-2" data-lang-key="caption3D">Phối cảnh 3D</p>
                                </div>
                                <div class="p-3 bg-slate-50 rounded-lg">
                                    <img src="https://res.cloudinary.com/dtvjtjf4i/image/upload/v1760604848/BIM-OUTPUT_Schedule_for_Fur_and_Mac_eal8bs.jpg" alt="BIM Schedule" class="rounded-md shadow-sm w-full border">
                                    <p class="text-center text-sm font-semibold text-slate-600 mt-2" data-lang-key="captionSchedule">Bảng thống kê Nội thất & Thiết bị</p>
                                </div>
                                <div class="p-3 bg-slate-50 rounded-lg">
                                    <img src="https://res.cloudinary.com/dtvjtjf4i/image/upload/v1760604848/BIM-OUTPUT_Room_Floor_Plan_-_NEW_xtn8no.jpg" alt="BIM New Floor Plan" class="rounded-md shadow-sm w-full border">
                                    <p class="text-center text-sm font-semibold text-slate-600 mt-2" data-lang-key="captionNewPlan">Mặt bằng bố trí vật dụng (Mới)</p>
                                </div>
                                <div class="p-3 bg-slate-50 rounded-lg">
                                    <img src="https://res.cloudinary.com/dtvjtjf4i/image/upload/v1760605134/BIM-OUTPUT_Room_Floor_Plan_-_OLD_ifmale.jpg" alt="BIM Old Floor Plan" class="rounded-md shadow-sm w-full border">
                                    <p class="text-center text-sm font-semibold text-slate-600 mt-2" data-lang-key="captionOldPlan">Mặt bằng bố trí vật dụng (Cũ)</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Outdoor Section -->
                    <div class="p-6 bg-white rounded-xl shadow-md">
                        <h3 class="text-2xl font-bold text-cyan-800 mb-4 border-l-4 border-cyan-500 pl-4" data-lang-key="outdoorSectionTitle">Không gian Ngoài trời (Outdoor)</h3>
                        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                             <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="signageTitle">Thiết kế hệ thống Bảng hiệu</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="signageDesc"><b>Mục tiêu:</b> Nâng cao nhận diện thương hiệu và cải thiện trải nghiệm điều hướng trong campus. <br><b>Phạm vi:</b> Khảo sát hiện trạng, đề xuất các mẫu thiết kế mới, lựa chọn vật liệu và vị trí lắp đặt. Làm việc với nhà thầu để nhận báo giá và lên kế hoạch thi công.</p>
                            </div>
                            <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="spaceDesignTitle">Thiết kế Không gian</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="spaceDesignDesc"><b>Mục tiêu:</b> Tạo dựng môi trường làm việc và học tập xanh, thân thiện và truyền cảm hứng. <br><b>Phạm vi:</b> Khảo sát mặt bằng và nhu cầu, lên ý tưởng quy hoạch lại các khu vực cây xanh, lối đi bộ, khu vực nghỉ ngơi. Làm việc với các đơn vị thiết kế để có phương án và báo giá chi tiết.</p>
                            </div>
                            <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="energyMgmtTitle">Quản lý Năng lượng</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="energyMgmtDesc"><b>Mục tiêu:</b> Tối ưu hóa việc sử dụng năng lượng, giảm chi phí vận hành và hướng tới công trình xanh. <br><b>Phạm vi:</b> Xây dựng bộ hướng dẫn sử dụng năng lượng hiệu quả, tham khảo từ tiêu chí của EDGE. Người thực hiện: Huỳnh + Nghĩa.</p>
                            </div>
                             <div class="p-4 border border-slate-200 rounded-lg bg-slate-50 md:col-span-2 lg:col-span-3">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="trafficModelingTitle">Mô hình hóa Giao thông & Cảnh quan</h4>
                                <p class="text-sm text-slate-600 mt-2" data-lang-key="trafficModelingDesc"><b>Mục tiêu:</b> Hoàn thiện mô hình "song sinh kỹ thuật số" cho toàn bộ không gian ngoài trời. <br><b>Phạm vi:</b> Tái tạo mô hình 3D cho toàn bộ hệ thống đường nội bộ, lối đi bộ, cây xanh, và các yếu tố cảnh quan khác. Dữ liệu này phục vụ cho việc quy hoạch, phân tích và mô phỏng trong tương lai.</p>
                            </div>
                        </div>
                    </div>
                 </div>
            </section>
            
            <section id="dashboard-page">
                <main>
                    <section id="indoor-section" class="mb-16 p-6 bg-white rounded-xl shadow-md">
                        <h2 class="text-2xl font-bold text-cyan-800 mb-4 border-l-4 border-cyan-500 pl-4" data-lang-key="dbIndoorTitle">Không gian Trong nhà (Indoor)</h2>
                        <p class="text-slate-600 mb-8" data-lang-key="dbIndoorDesc">Phần này trình bày tiến độ chi tiết của dự án mô hình hóa thông tin hình học theo từng tòa nhà và tiến độ chung của thông tin phi hình học.</p>
                        <div class="grid md:grid-cols-2 gap-8 items-start">
                            <div>
                                <h3 class="font-bold text-lg text-slate-700 mb-3" data-lang-key="dbBuildingProgressTitle">Tiến độ Mô hình hóa Hình học theo Tòa nhà</h3>
                                <div class="max-h-96 overflow-y-auto pr-2 space-y-3 custom-scrollbar border rounded-lg p-3 bg-slate-50">
                                    <div id="building-list"></div>
                                </div>
                                <div class="p-4 border border-slate-200 rounded-lg bg-slate-50 mt-4">
                                    <h3 class="font-bold text-lg text-slate-700" data-lang-key="dbNonGeoTitle">Thông tin Phi hình học (Toàn bộ)</h3>
                                    <p class="text-sm text-slate-500" data-lang-key="dbNonGeoDesc">Gán thuộc tính: mã, chức năng, sức chứa...</p>
                                     <div class="w-full bg-slate-200 rounded-full h-2.5 mt-2">
                                        <div class="bg-sky-500 h-2.5 rounded-full" style="width: 5%"></div>
                                    </div>
                                    <p class="text-right text-sm font-semibold text-sky-600">5%</p>
                                </div>
                            </div>
                            <div class="w-full">
                                <div class="chart-container flex flex-col items-center justify-center" style="max-width: 400px; height: 320px;">
                                    <canvas id="indoorOverallProgressChart"></canvas>
                                     <div id="average-progress-text" class="text-center -mt-16"></div>
                                </div>
                                <p class="text-center text-sm text-slate-500 mt-2" data-lang-key="dbIndoorChartCaption">Biểu đồ tổng quan tiến độ trung bình của 17 tòa nhà.</p>
                            </div>
                        </div>
                    </section>

                    <section id="outdoor-section" class="mb-16 p-6 bg-white rounded-xl shadow-md">
                        <h2 class="text-2xl font-bold text-cyan-800 mb-6 border-l-4 border-cyan-500 pl-4" data-lang-key="dbOutdoorTitle">Không gian Ngoài trời (Outdoor)</h2>
                        
                        <div>
                            <h3 class="text-xl font-semibold text-slate-700 mb-4" data-lang-key="dbOutdoorPart1Title">Phần 1: Làm việc chung với nhà Thầu</h3>
                            <p class="text-slate-600 mb-8" data-lang-key="dbOutdoorPart1Desc">Trình bày tiến độ triển khai các đề xuất cải thiện không gian chung. Nhấp vào từng hạng mục để xem chi tiết.</p>
                            <div class="grid lg:grid-cols-3 gap-6">
                                <div class="lg:col-span-1 flex flex-col space-y-4">
                                    <div id="card-signage" class="outdoor-card p-4 border-2 border-transparent rounded-lg bg-slate-50 cursor-pointer hover:shadow-lg transition-all duration-300">
                                        <h4 class="font-bold text-lg text-slate-700" data-lang-key="cardSignageTitle">Thiết kế hệ thống Bảng hiệu</h4>
                                        <p class="text-sm text-slate-500 mb-2" data-lang-key="cardSignageDesc">Tăng nhận diện thương hiệu và tối ưu điều hướng.</p>
                                        <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-amber-600 bg-amber-200" data-lang-key="statusInProgress">
                                            Đang triển khai
                                        </span>
                                    </div>
                                     <div id="card-space" class="outdoor-card p-4 border-2 border-transparent rounded-lg bg-slate-50 cursor-pointer hover:shadow-lg transition-all duration-300">
                                        <h4 class="font-bold text-lg text-slate-700" data-lang-key="cardSpaceTitle">Thiết kế Không gian</h4>
                                        <p class="text-sm text-slate-500 mb-2" data-lang-key="cardSpaceDesc">Quy hoạch cây xanh, lối đi, khu vực nghỉ ngơi.</p>
                                        <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-amber-600 bg-amber-200" data-lang-key="statusInProgress">
                                            Đang triển khai
                                        </span>
                                    </div>
                                    <div id="card-energy" class="outdoor-card p-4 border-2 border-transparent rounded-lg bg-slate-50 cursor-pointer hover:shadow-lg transition-all duration-300">
                                        <h4 class="font-bold text-lg text-slate-700" data-lang-key="cardEnergyTitle">Quản lý Năng lượng</h4>
                                        <p class="text-sm text-slate-500 mb-2" data-lang-key="cardEnergyDesc">Sử dụng hiệu quả hệ thống chiếu sáng, tưới tiêu.</p>
                                        <span class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-amber-600 bg-amber-200" data-lang-key="statusInProgress">
                                            Đang triển khai
                                        </span>
                                    </div>
                                </div>
                                <div class="lg:col-span-2 p-4 border border-slate-200 rounded-lg bg-white min-h-[250px]">
                                    <h4 id="outdoor-detail-title" class="text-xl font-bold text-cyan-700 mb-2" data-lang-key="detailTitle">Chi tiết Hạng mục</h4>
                                    <p id="outdoor-detail-content" class="text-slate-600" data-lang-key="detailPlaceholder">Vui lòng chọn một hạng mục bên trái để xem thông tin chi tiết.</p>
                                </div>
                            </div>
                             <div class="mt-8">
                                 <div class="chart-container" style="max-width: 100%;">
                                    <canvas id="outdoorChart"></canvas>
                                </div>
                                <p class="text-center text-sm text-slate-500 mt-2" data-lang-key="dbOutdoorChartCaption">Biểu đồ so sánh tiến độ các dự án ngoài trời.</p>
                             </div>
                        </div>

                        <hr class="my-10 border-slate-200">

                        <div>
                            <h3 class="text-xl font-semibold text-slate-700 mb-4" data-lang-key="dbOutdoorPart2Title">Phần 2: Mô hình hóa Giao thông & Cảnh quan</h3>
                            <div class="p-4 border border-slate-200 rounded-lg bg-slate-50">
                                <h4 class="font-bold text-lg text-slate-700" data-lang-key="dbTrafficModelingTitle">Dựng model giao thông và cảnh quan campus</h4>
                                <p class="text-sm text-slate-500" data-lang-key="dbTrafficModelingDesc">Tái tạo mô hình 3D cho hệ thống đường, lối đi, cây xanh và các yếu tố cảnh quan khác.</p>
                                <div class="w-full bg-slate-200 rounded-full h-2.5 mt-2">
                                    <div class="bg-teal-500 h-2.5 rounded-full" style="width: 5%"></div>
                                </div>
                                <p class="text-right text-sm font-semibold text-teal-600">5%</p>
                            </div>
                        </div>
                    </section>
                    
                    <section id="next-steps-section" class="p-6 bg-white rounded-xl shadow-md">
                         <h2 class="text-2xl font-bold text-cyan-800 mb-4 border-l-4 border-cyan-500 pl-4" data-lang-key="nextStepsTitle">Kế hoạch & Đề xuất</h2>
                         <div class="grid md:grid-cols-2 gap-8">
                            <div>
                                <h3 class="font-bold text-lg mb-2 text-slate-700" data-lang-key="nextStepsPlanTitle">Kế hoạch cho kỳ tiếp theo</h3>
                                <ul class="list-disc list-inside space-y-2 text-slate-600" data-lang-key="nextStepsPlanItems">
                                    <li><strong class="font-semibold text-slate-700">Indoor:</strong> Tích hợp dữ liệu mô hình vào phần mềm quản lý và đào tạo các bộ phận liên quan.</li>
                                    <li><strong class="font-semibold text-slate-700">Outdoor:</strong> Hoàn thiện và trình duyệt proposal thiết kế không gian, lập kế hoạch ngân sách và tiến độ cho hệ thống bảng hiệu.</li>
                                </ul>
                            </div>
                             <div>
                                <h3 class="font-bold text-lg mb-2 text-slate-700" data-lang-key="nextStepsIssuesTitle">Khó khăn & Đề xuất</h3>
                                <p class="text-slate-600 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-r-lg" data-lang-key="nextStepsIssuesContent">
                                   <strong class="font-semibold text-amber-800">Khó khăn: </strong>Việc thu thập dữ liệu phi hình học từ một số phòng ban còn chậm trễ.
                                   <br>
                                   <strong class="font-semibold text-green-800">Đề xuất: </strong>Tổ chức một cuộc họp chung để phổ biến tầm quan trọng của dự án và thống nhất thời hạn cung cấp thông tin.
                                </p>
                            </div>
                         </div>
                    </section>

                </main>
            </section>

        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // --- DATA & TRANSLATIONS ---
            const translations = {
                vi: {
                    mainTitle: "Dự án Quản lý Không gian Toàn diện",
                    navProposal: "Proposal",
                    navDashboard: "Báo cáo Tiến độ",
                    proposalTitle: "Đề xuất Kế hoạch",
                    proposalSubtitle: "Mô tả chi tiết mục tiêu và phạm vi công việc của từng hạng mục trong dự án.",
                    indoorSectionTitle: "Không gian Trong nhà (Indoor)",
                    geoModelingTitle: "Mô hình hóa Thông tin Hình học",
                    geoModelingDesc: "<b>Mục tiêu:</b> Xây dựng nền tảng \"song sinh kỹ thuật số\" (Digital Twin) cho toàn bộ 17 tòa nhà trong campus. <br><b>Phạm vi:</b> Dựng mô hình 2D và 3D chính xác, thể hiện đúng kích thước, vị trí, diện tích của từng phòng, hành lang, và các không gian chức năng khác. Đây là lớp dữ liệu cơ sở cho mọi hoạt động quản lý về sau.",
                    nonGeoModelingTitle: "Mô hình hóa Thông tin Phi hình học",
                    nonGeoModelingDesc: "<b>Mục tiêu:</b> Làm giàu mô hình hình học bằng các dữ liệu vận hành. <br><b>Phạm vi:</b> Gán các thuộc tính quan trọng vào từng không gian trong mô hình, bao gồm: mã phòng, tên gọi, chức năng sử dụng, sức chứa, tình trạng, và danh sách tài sản liên quan. Dữ liệu này giúp tối ưu hóa việc sử dụng không gian và quản lý tài sản.",
                    bridgeTitle: "Cầu nối giữa Mô hình và Thực tế: Xây dựng Quy trình Vận hành",
                    bridgeDesc: "Để hiện thực hóa tiềm năng của mô hình thông tin, bước tiếp theo là xây dựng một bộ <strong>hướng dẫn và quy trình vận hành</strong> chi tiết. Điều này đảm bảo rằng các nhóm có thể khai thác dữ liệu từ mô hình một cách nhất quán và hiệu quả, làm cầu nối giữa việc \"có mô hình\" và \"sử dụng được mô hình\" để thực hiện các công tác quản lý.",
                    resultsTitle: "Kết quả kỳ vọng: Các tác vụ có thể đạt được khi có quy trình vận hành",
                    group1Title: "I. Nhóm Task Chính – Quản lý & Vận hành Cốt lõi",
                    group1Items: "<li><b>Quản lý phòng ốc:</b> Xuất Room Schedule, theo dõi tỉ lệ sử dụng, lập sơ đồ màu trực quan.</li><li><b>Quản lý tài sản:</b> Xuất danh sách nội thất, liên kết mã tài sản, lập kế hoạch bảo trì.</li><li><b>Quản lý cấu kiện:</b> Thống kê số lượng cửa, vật liệu để lên kế hoạch sơn sửa, thay thế.</li><li><b>Kiểm tra quy chuẩn:</b> Đối chiếu tự động với QCVN/TCVN, flag các phòng không đạt chuẩn.</li>",
                    group2Title: "II. Nhóm Task Phụ – Phân tích & Hỗ trợ Quyết định",
                    group2Items: "<li><b>Phân tích chiếu sáng:</b> Tính tỉ lệ diện tích cửa sổ, phân tích hướng nắng để đề xuất giải pháp tiết kiệm năng lượng.</li><li><b>Phân tích hiệu quả không gian:</b> Phát hiện phòng bị chiếm dụng sai mục đích, đề xuất tái bố trí.</li><li><b>Phân tích vòng đời tài sản:</b> Theo dõi tuổi thọ thiết bị, ước tính chi phí bảo trì và lập kế hoạch thay thế dài hạn.</li><li><b>Phân tích năng lượng (nâng cao):</b> Xuất mô hình sang phần mềm chuyên dụng để tính toán năng lượng tiêu thụ, tải lạnh.</li>",
                    group3Title: "III. Nhóm Task Kết Nối & Chuyển giao Dữ liệu",
                    group3Items: "<li><b>Xuất dữ liệu:</b> Export sang Excel, Power BI để tạo dashboard vận hành thời gian thực.</li><li><b>Kết nối hệ thống:</b> Tích hợp với các phần mềm CMMS/FM để vận hành số.</li><li><b>Bàn giao số hóa:</b> Tạo bộ hồ sơ as-built BIM cho các đơn vị liên quan.</li><li><b>Liên kết bản đồ:</b> Tích hợp với GIS hoặc bản đồ nội bộ để quản lý trên nền tảng bản đồ.</li>",
                    exampleTitle: "Ví dụ Output từ Mô hình hóa cho Phòng mẫu (Phòng thực hành điện B3-109)",
                    exampleDesc: "Dưới đây là một số kết quả đầu ra trực quan từ việc xây dựng mô hình thông tin cho một phòng mẫu, minh họa cho khả năng trích xuất dữ liệu của hệ thống.",
                    caption3D: "Phối cảnh 3D",
                    captionSchedule: "Bảng thống kê Nội thất & Thiết bị",
                    captionNewPlan: "Mặt bằng bố trí vật dụng (Mới)",
                    captionOldPlan: "Mặt bằng bố trí vật dụng (Cũ)",
                    outdoorSectionTitle: "Không gian Ngoài trời (Outdoor)",
                    signageTitle: "Thiết kế hệ thống Bảng hiệu",
                    signageDesc: "<b>Mục tiêu:</b> Nâng cao nhận diện thương hiệu và cải thiện trải nghiệm điều hướng trong campus. <br><b>Phạm vi:</b> Khảo sát hiện trạng, đề xuất các mẫu thiết kế mới, lựa chọn vật liệu và vị trí lắp đặt. Làm việc với nhà thầu để nhận báo giá và lên kế hoạch thi công.",
                    spaceDesignTitle: "Thiết kế Không gian",
                    spaceDesignDesc: "<b>Mục tiêu:</b> Tạo dựng môi trường làm việc và học tập xanh, thân thiện và truyền cảm hứng. <br><b>Phạm vi:</b> Khảo sát mặt bằng và nhu cầu, lên ý tưởng quy hoạch lại các khu vực cây xanh, lối đi bộ, khu vực nghỉ ngơi. Làm việc với các đơn vị thiết kế để có phương án và báo giá chi tiết.",
                    energyMgmtTitle: "Quản lý Năng lượng",
                    energyMgmtDesc: "<b>Mục tiêu:</b> Tối ưu hóa việc sử dụng năng lượng, giảm chi phí vận hành và hướng tới công trình xanh. <br><b>Phạm vi:</b> Xây dựng bộ hướng dẫn sử dụng năng lượng hiệu quả, tham khảo từ tiêu chí của EDGE. Người thực hiện: Huỳnh + Nghĩa.",
                    trafficModelingTitle: "Mô hình hóa Giao thông & Cảnh quan",
                    trafficModelingDesc: "<b>Mục tiêu:</b> Hoàn thiện mô hình \"song sinh kỹ thuật số\" cho toàn bộ không gian ngoài trời. <br><b>Phạm vi:</b> Tái tạo mô hình 3D cho toàn bộ hệ thống đường nội bộ, lối đi bộ, cây xanh, và các yếu tố cảnh quan khác. Dữ liệu này phục vụ cho việc quy hoạch, phân tích và mô phỏng trong tương lai.",
                    dbIndoorTitle: "Không gian Trong nhà (Indoor)",
                    dbIndoorDesc: "Phần này trình bày tiến độ chi tiết của dự án mô hình hóa thông tin hình học theo từng tòa nhà và tiến độ chung của thông tin phi hình học.",
                    dbBuildingProgressTitle: "Tiến độ Mô hình hóa Hình học theo Tòa nhà",
                    dbNonGeoTitle: "Thông tin Phi hình học (Toàn bộ)",
                    dbNonGeoDesc: "Gán thuộc tính: mã, chức năng, sức chứa...",
                    dbIndoorChartCaption: "Biểu đồ tổng quan tiến độ trung bình của 17 tòa nhà.",
                    avgProgressText: "Tiến độ trung bình",
                    dbOutdoorTitle: "Không gian Ngoài trời (Outdoor)",
                    dbOutdoorPart1Title: "Phần 1: Làm việc chung với nhà Thầu",
                    dbOutdoorPart1Desc: "Trình bày tiến độ triển khai các đề xuất cải thiện không gian chung. Nhấp vào từng hạng mục để xem chi tiết.",
                    cardSignageTitle: "Thiết kế hệ thống Bảng hiệu",
                    cardSignageDesc: "Tăng nhận diện thương hiệu và tối ưu điều hướng.",
                    cardSpaceTitle: "Thiết kế Không gian",
                    cardSpaceDesc: "Quy hoạch cây xanh, lối đi, khu vực nghỉ ngơi.",
                    cardEnergyTitle: "Quản lý Năng lượng",
                    cardEnergyDesc: "Sử dụng hiệu quả hệ thống chiếu sáng, tưới tiêu.",
                    statusInProgress: "Đang triển khai",
                    detailTitle: "Chi tiết Hạng mục",
                    detailPlaceholder: "Vui lòng chọn một hạng mục bên trái để xem thông tin chi tiết.",
                    dbOutdoorChartCaption: "Biểu đồ so sánh tiến độ các dự án ngoài trời.",
                    dbOutdoorPart2Title: "Phần 2: Mô hình hóa Giao thông & Cảnh quan",
                    dbTrafficModelingTitle: "Dựng model giao thông và cảnh quan campus",
                    dbTrafficModelingDesc: "Tái tạo mô hình 3D cho hệ thống đường, lối đi, cây xanh và các yếu tố cảnh quan khác.",
                    nextStepsTitle: "Kế hoạch & Đề xuất",
                    nextStepsPlanTitle: "Kế hoạch cho kỳ tiếp theo",
                    nextStepsPlanItems: "<li><strong class=\"font-semibold text-slate-700\">Indoor:</strong> Tích hợp dữ liệu mô hình vào phần mềm quản lý và đào tạo các bộ phận liên quan.</li><li><strong class=\"font-semibold text-slate-700\">Outdoor:</strong> Hoàn thiện và trình duyệt proposal thiết kế không gian, lập kế hoạch ngân sách và tiến độ cho hệ thống bảng hiệu.</li>",
                    nextStepsIssuesTitle: "Khó khăn & Đề xuất",
                    nextStepsIssuesContent: "<strong class=\"font-semibold text-amber-800\">Khó khăn: </strong>Việc thu thập dữ liệu phi hình học từ một số phòng ban còn chậm trễ.<br><strong class=\"font-semibold text-green-800\">Đề xuất: </strong>Tổ chức một cuộc họp chung để phổ biến tầm quan trọng của dự án và thống nhất thời hạn cung cấp thông tin."
                },
                en: {
                    mainTitle: "Comprehensive Space Management Project",
                    navProposal: "Proposal",
                    navDashboard: "Progress Report",
                    proposalTitle: "Project Proposal",
                    proposalSubtitle: "Detailed description of the objectives and scope for each item in the project.",
                    indoorSectionTitle: "Indoor Space",
                    geoModelingTitle: "Geometric Information Modeling",
                    geoModelingDesc: "<b>Objective:</b> Build a 'Digital Twin' platform for all 17 buildings on campus. <br><b>Scope:</b> Create accurate 2D and 3D models representing the correct dimensions, locations, and areas of each room, corridor, and other functional spaces. This is the foundational data layer for all subsequent management activities.",
                    nonGeoModelingTitle: "Non-Geometric Information Modeling",
                    nonGeoModelingDesc: "<b>Objective:</b> Enrich the geometric model with operational data. <br><b>Scope:</b> Assign important attributes to each space in the model, including: room code, name, function, capacity, status, and a list of related assets. This data helps optimize space utilization and asset management.",
                    bridgeTitle: "The Bridge Between Model and Reality: Building Operational Procedures",
                    bridgeDesc: "To realize the potential of the information model, the next step is to build a detailed set of <strong>guidelines and operational procedures</strong>. This ensures that teams can leverage data from the model consistently and effectively, bridging the gap between 'having a model' and 'using the model' to perform management tasks.",
                    resultsTitle: "Expected Outcomes: Tasks Achievable with Operational Procedures",
                    group1Title: "I. Core Tasks – Core Management & Operations",
                    group1Items: "<li><b>Room Management:</b> Export Room Schedules, track utilization rates, create intuitive color schemes.</li><li><b>Asset Management:</b> Export furniture/equipment lists, link internal asset codes, plan maintenance schedules.</li><li><b>Component Management:</b> Tally door/window counts, track materials for planning repairs and replacements.</li><li><b>Standard Compliance Check:</b> Automatically check against national standards (QCVN/TCVN), flag non-compliant rooms.</li>",
                    group2Title: "II. Ancillary Tasks – Analysis & Decision Support",
                    group2Items: "<li><b>Lighting Analysis:</b> Calculate window-to-floor area ratios, analyze sun orientation to suggest energy-saving solutions.</li><li><b>Space Efficiency Analysis:</b> Identify rooms used for unintended purposes, propose re-layouts.</li><li><b>Asset Lifecycle Analysis:</b> Track equipment age, estimate future maintenance costs, and plan long-term replacements.</li><li><b>Energy Analysis (Advanced):</b> Export models to specialized software to calculate energy consumption and cooling loads.</li>",
                    group3Title: "III. Connectivity & Data Transfer Tasks",
                    group3Items: "<li><b>Data Export:</b> Export to Excel, Power BI to create real-time operational dashboards.</li><li><b>System Integration:</b> Connect with CMMS/FM software for digital operations.</li><li><b>Digital Handover:</b> Create as-built BIM packages for relevant parties.</li><li><b>Map Linking:</b> Integrate with GIS or internal maps for management on a map-based platform.</li>",
                    exampleTitle: "Example Output from a Model Room (Electrical Workshop B3-109)",
                    exampleDesc: "Below are some visual outputs from building the information model for a sample room, illustrating the system's data extraction capabilities.",
                    caption3D: "3D Perspective View",
                    captionSchedule: "Furniture & Equipment Schedule",
                    captionNewPlan: "Furniture Layout Plan (New)",
                    captionOldPlan: "Furniture Layout Plan (Old)",
                    outdoorSectionTitle: "Outdoor Space",
                    signageTitle: "Signage System Design",
                    signageDesc: "<b>Objective:</b> Enhance brand identity and improve navigation experience on campus. <br><b>Scope:</b> Conduct site surveys, propose new designs, select materials and locations. Work with contractors to get quotes and plan for execution.",
                    spaceDesignTitle: "Space Design",
                    spaceDesignDesc: "<b>Objective:</b> Create a green, friendly, and inspiring environment for work and study. <br><b>Scope:</b> Survey the area and user needs, brainstorm ideas for replanning green areas, walkways, and rest areas. Work with design firms for detailed plans and quotes.",
                    energyMgmtTitle: "Energy Management",
                    energyMgmtDesc: "<b>Objective:</b> Optimize energy use, reduce operational costs, and move towards a green building standard. <br><b>Scope:</b> Develop energy efficiency guidelines based on EDGE criteria. Implemented by: Huynh + Nghia.",
                    trafficModelingTitle: "Traffic & Landscape Modeling",
                    trafficModelingDesc: "<b>Objective:</b> Complete the 'digital twin' model for the entire outdoor space. <br><b>Scope:</b> Recreate a 3D model of the entire internal road system, walkways, green spaces, and other landscape elements. This data will serve future planning, analysis, and simulation.",
                    dbIndoorTitle: "Indoor Space",
                    dbIndoorDesc: "This section presents the detailed progress of the geometric information modeling project for each building and the overall progress of non-geometric information.",
                    dbBuildingProgressTitle: "Geometric Modeling Progress by Building",
                    dbNonGeoTitle: "Non-Geometric Information (Overall)",
                    dbNonGeoDesc: "Assigning attributes: code, function, capacity...",
                    dbIndoorChartCaption: "Overview chart of the average progress for 17 buildings.",
                    avgProgressText: "Average Progress",
                    dbOutdoorTitle: "Outdoor Space",
                    dbOutdoorPart1Title: "Part 1: Working with Contractors",
                    dbOutdoorPart1Desc: "Presents the implementation progress of proposals to improve common areas. Click on each item for details.",
                    cardSignageTitle: "Signage System Design",
                    cardSignageDesc: "Enhance brand identity and optimize navigation.",
                    cardSpaceTitle: "Space Design",
                    cardSpaceDesc: "Planning green areas, walkways, and rest areas.",
                    cardEnergyTitle: "Energy Management",
                    cardEnergyDesc: "Efficient use of lighting and irrigation systems.",
                    statusInProgress: "In Progress",
                    detailTitle: "Item Details",
                    detailPlaceholder: "Please select an item on the left to see detailed information.",
                    dbOutdoorChartCaption: "Chart comparing the progress of outdoor projects.",
                    dbOutdoorPart2Title: "Part 2: Traffic & Landscape Modeling",
                    dbTrafficModelingTitle: "Modeling Campus Traffic and Landscape",
                    dbTrafficModelingDesc: "Recreating a 3D model of the road system, walkways, greenery, and other landscape elements.",
                    nextStepsTitle: "Plan & Proposals",
                    nextStepsPlanTitle: "Plan for the next period",
                    nextStepsPlanItems: "<li><strong class=\"font-semibold text-slate-700\">Indoor:</strong> Integrate model data into management software and train relevant departments.</li><li><strong class=\"font-semibold text-slate-700\">Outdoor:</strong> Finalize and submit the space design proposal, develop a budget and schedule for the signage system.</li>",
                    nextStepsIssuesTitle: "Issues & Recommendations",
                    nextStepsIssuesContent: "<strong class=\"font-semibold text-amber-800\">Issue: </strong>Collection of non-geometric data from some departments is delayed.<br><strong class=\"font-semibold text-green-800\">Recommendation: </strong>Organize a general meeting to communicate the project's importance and set a deadline for providing information."
                }
            };

            const reportData = {
                buildings: [
                    { vi: "Tòa nhà hành chính", en: "Admin Building", progress: 2 },
                    { vi: "Tòa nhà triển lãm", en: "Exhibition Hall", progress: 10 },
                    { vi: "Tòa nhà thư viện", en: "Library Building", progress: 10 },
                    { vi: "Tòa nhà giảng đường", en: "Lecture Hall", progress: 10 },
                    { vi: "Tòa nhà hội trường", en: "Auditorium", progress: 2 },
                    { vi: "Tòa nhà ăn", en: "Cafeteria Building", progress: 10 },
                    { vi: "Tòa nhà thể thao+ hồ bơi+ sân tập", en: "Sports Complex", progress: 10 },
                    { vi: "Tòa nhà trung tâm", en: "Center Building", progress: 10 },
                    { vi: "Tòa nhà học thuật 1", en: "Academic Building 1", progress: 15 },
                    { vi: "Tòa nhà học thuật 2", en: "Academic Building 2", progress: 15 },
                    { vi: "Tòa nhà học thuật 3", en: "Academic Building 3", progress: 15 },
                    { vi: "Tòa nhà học thuật 5", en: "Academic Building 5", progress: 10 },
                    { vi: "Tòa nhà học thuật 6", en: "Academic Building 6", progress: 10 },
                    { vi: "Tòa nhà khách", en: "Guest House", progress: 2 },
                    { vi: "Khu nhà villa", en: "Villa Area", progress: 10 },
                    { vi: "Nhà kí túc xá 1", en: "Dormitory 1", progress: 10 },
                    { vi: "Nhà kí túc xá 2", en: "Dormitory 2", progress: 10 },
                ],
                outdoor: {
                    signage: {
                        vi: { title: 'Thiết kế hệ thống Bảng hiệu', content: 'Đã hoàn thành khảo sát hiện trạng. Hiện đang trong giai đoạn làm việc với các nhà thầu thiết kế để nhận báo giá chi tiết cho việc sản xuất và lắp đặt.'},
                        en: { title: 'Signage System Design', content: 'Site survey is complete. Currently working with design contractors to receive detailed quotes for production and installation.' }
                    },
                    space: {
                        vi: { title: 'Thiết kế Không gian', content: 'Phần khảo sát mặt bằng và nhu cầu sử dụng đã hoàn tất. Đang tiến hành làm việc với đơn vị thiết kế để có báo giá cho các hạng mục cải tạo không gian.' },
                        en: { title: 'Space Design', content: 'The site and user needs survey has been completed. Currently working with the design firm to obtain quotes for space renovation items.' }
                    },
                    energy: {
                        vi: { title: 'Hướng dẫn Quản lý Năng lượng', content: 'Bản hướng dẫn sơ bộ đang được triển khai (Huỳnh + Nghĩa). Tài liệu này cung cấp các quy định và gợi ý về việc sử dụng hiệu quả năng lượng được tham khảo từ tiêu chí của EDGE, nhằm tiết kiệm năng lượng và giảm chi phí vận hành.' },
                        en: { title: 'Energy Management Guidelines', content: 'Preliminary guidelines are being implemented (by Huynh + Nghia). This document provides regulations and suggestions for efficient energy use, referenced from EDGE criteria, to save energy and reduce operating costs.' }
                    }
                }
            };
            
            let currentLang = 'vi';
            let indoorChartInstance, outdoorChartInstance;

            // --- NAVIGATION ---
            const navProposal = document.getElementById('nav-proposal');
            const navDashboard = document.getElementById('nav-dashboard');
            const proposalPage = document.getElementById('proposal-page');
            const dashboardPage = document.getElementById('dashboard-page');
            const navButtons = [navProposal, navDashboard];
            const langBtnVi = document.getElementById('lang-vi');
            const langBtnEn = document.getElementById('lang-en');

            function switchPage(pageToShow) {
                proposalPage.classList.add('hidden');
                dashboardPage.classList.add('hidden');
                navButtons.forEach(btn => btn.classList.remove('active'));

                if (pageToShow === 'proposal') {
                    proposalPage.classList.remove('hidden');
                    navProposal.classList.add('active');
                } else {
                    dashboardPage.classList.remove('hidden');
                    navDashboard.classList.add('active');
                }
            }
            
            function setLanguage(lang) {
                currentLang = lang;
                const langElements = document.querySelectorAll('[data-lang-key]');
                langElements.forEach(el => {
                    const key = el.getAttribute('data-lang-key');
                    if (translations[lang][key]) {
                        el.innerHTML = translations[lang][key];
                    }
                });

                if (lang === 'vi') {
                    langBtnVi.classList.add('bg-cyan-600', 'text-white', 'shadow');
                    langBtnEn.classList.remove('bg-cyan-600', 'text-white', 'shadow');
                } else {
                    langBtnEn.classList.add('bg-cyan-600', 'text-white', 'shadow');
                    langBtnVi.classList.remove('bg-cyan-600', 'text-white', 'shadow');
                }
                
                renderDashboard(lang);
                // Reset outdoor card selection on lang change
                const firstCard = document.querySelector('.outdoor-card');
                if (firstCard) firstCard.click();
            }

            // --- RENDER FUNCTIONS ---
            function renderDashboard(lang) {
                renderBuildingList(lang);
                renderCharts(lang);
            }

            function renderBuildingList(lang) {
                const buildingListContainer = document.getElementById('building-list');
                buildingListContainer.innerHTML = '';
                reportData.buildings.forEach(building => {
                    const buildingEl = document.createElement('div');
                    buildingEl.className = 'p-2 rounded-md';
                    buildingEl.innerHTML = `
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-slate-700 text-sm font-medium">${building[lang]}</span>
                            <span class="text-sm font-semibold text-cyan-700">${building.progress}%</span>
                        </div>
                        <div class="w-full bg-slate-200 rounded-full h-1.5">
                            <div class="bg-cyan-500 h-1.5 rounded-full" style="width: ${building.progress}%"></div>
                        </div>
                    `;
                    buildingListContainer.appendChild(buildingEl);
                });
            }

            function renderCharts(lang) {
                if(indoorChartInstance) indoorChartInstance.destroy();
                if(outdoorChartInstance) outdoorChartInstance.destroy();

                const totalProgress = reportData.buildings.reduce((sum, building) => sum + building.progress, 0);
                const averageProgress = (totalProgress / reportData.buildings.length).toFixed(1);

                const indoorOverallCtx = document.getElementById('indoorOverallProgressChart').getContext('2d');
                indoorChartInstance = new Chart(indoorOverallCtx, {
                    type: 'doughnut', data: {
                        labels: [lang === 'vi' ? 'Hoàn thành' : 'Completed', lang === 'vi' ? 'Còn lại' : 'Remaining'],
                        datasets: [{ data: [averageProgress, 100 - averageProgress], backgroundColor: ['#06b6d4', '#e2e8f0'], borderColor: '#ffffff', borderWidth: 4, circumference: 270, rotation: 225, }]
                    },
                    options: { responsive: true, maintainAspectRatio: false, cutout: '80%', plugins: { legend: { display: false }, tooltip: { enabled: false } } }
                });
                
                document.getElementById('average-progress-text').innerHTML = `
                    <span class="text-4xl font-bold text-cyan-800">${averageProgress}%</span>
                    <p class="text-sm text-slate-500">${translations[lang].avgProgressText}</p>`;

                const outdoorCtx = document.getElementById('outdoorChart').getContext('2d');
                outdoorChartInstance = new Chart(outdoorCtx, {
                    type: 'bar',
                    data: {
                        labels: [translations[lang].cardSignageTitle, translations[lang].cardSpaceTitle, translations[lang].cardEnergyTitle],
                        datasets: [{
                            label: lang === 'vi' ? 'Tiến độ (%)' : 'Progress (%)',
                            data: [10, 10, 10],
                            backgroundColor: ['rgba(14, 165, 233, 0.6)', 'rgba(245, 158, 11, 0.6)', 'rgba(59, 130, 246, 0.6)'],
                            borderColor: ['#0ea5e9', '#f59e0b', '#3b82f6'],
                            borderWidth: 1
                        }]
                    },
                    options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, scales: { x: { beginAtZero: true, max: 100, ticks: { callback: (value) => value + "%" } } }, plugins: { legend: { display: false }, title: { display: true, text: translations[lang].dbOutdoorChartCaption } } }
                });
            }

            // --- EVENT LISTENERS & INITIALIZATION ---
            navProposal.addEventListener('click', () => switchPage('proposal'));
            navDashboard.addEventListener('click', () => switchPage('dashboard'));
            langBtnVi.addEventListener('click', () => setLanguage('vi'));
            langBtnEn.addEventListener('click', () => setLanguage('en'));
            
            const outdoorCards = document.querySelectorAll('.outdoor-card');
            const detailTitle = document.getElementById('outdoor-detail-title');
            const detailContent = document.getElementById('outdoor-detail-content');

            outdoorCards.forEach(card => {
                card.addEventListener('click', function() {
                    outdoorCards.forEach(c => c.classList.remove('active-card'));
                    this.classList.add('active-card');
                    const cardId = this.id.split('-')[1];
                    const data = reportData.outdoor[cardId][currentLang];
                    if (data) {
                        detailTitle.textContent = data.title;
                        detailContent.textContent = data.content;
                    }
                });
            });

            // Initial Load
            setLanguage(currentLang);
            switchPage('dashboard');
            if (outdoorCards.length > 0) outdoorCards[0].click();

        });
    </script>
</body>
</html>

